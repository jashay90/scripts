<tool id="hitsandclusters" name="Count hits per gene and cluster" version="0.1.0" python_template_version="2.7">
	<requirements>
	<requirement type="package" version="0.15.2">pysam</requirement>
	<requirement type="package" version="0.24.2">pandas</requirement>
	<requirement type="package" version="1.16.4">numpy</requirement>	
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
	    python '$__tool_directory__/countandcluster.py' -c '$clusters' -b '$bam' -g '$out1' -o '$out2'
    ]]></command>
    <inputs>
	    <param type="data" name="clusters" format="tabular" />
	    <param type="data" name="bam" format="bam" />
    </inputs>
    <outputs>
	    <data name="out1" format="tabular" />
	    <data name="out2" format="tabular" />
    </outputs>
    <tests>
	    <test>
		    <param name="clusters" value="allthethings.tsv"/>
		    <param name="bam" value="targets.bam"/>
		    <output name="out1" file="genesout.tsv"/>
		    <output name="out2" file="clustersout.tsv"/>
	    </test>
    </tests>
    <help><![CDATA[
        usage: countandcluster.py [-h] [-b BAM] -c CLUSTERS [-p MINPROP] [-g GENEOUT] [-o CLUSTEROUT]

optional arguments:
  -h, --help  show this help message and exit
  -b BAM          bam alignment file
  -c CLUSTERS     Tab-delimited file with genes and clusters
  -p MINPROP      minimum proportion of cluster covered
  -g GENEOUT     output file for gene counts
  -o CLUSTEROUT  output file for cluster counts

  ]]></help>
    <citations>
	     <citation type="bibtex">
@misc{githubseqtk,
  author = {LastTODO, FirstTODO},
  year = {TODO},
  title = {seqtk},
  publisher = {GitHub},
  journal = {GitHub repository},
  url = {https://github.com/jashay90/scripts},
}</citation>
    </citations>
</tool>

